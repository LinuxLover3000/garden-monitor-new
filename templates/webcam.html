{% extends "base.html" %}

{% block head %}
{% endblock %}

{% block body %}
<div class="content">
    <div class="block content">
        {%for img in imgs%}
        <img class="image transparent" src="../{{img.path.replace("\\", "/")}}" alt="{{img.prefix + img.number}}">
        {%endfor%}
        <img id="backward" class="button active" onclick="regress()" src="{{url_for("static", filename = "icons/backward.png")}}">
        <img id="play" class="button active" onclick="play()" src="{{url_for("static", filename = "icons/play.png")}}">
        <img id="pause" class="button hidden" onclick="pause()" src="{{url_for("static", filename = "icons/pause.png")}}">
        <img id="forward" class="button active" onclick="advance()" src="{{url_for("static", filename = "icons/forward.png")}}">
    </div>
</div>
<script>
    let imgs = document.getElementsByClassName("image");
    let playButton = document.getElementById("play");
    let pauseButton = document.getElementById("pause");
    let i = 0;
    visible(0);
    let playing = false;

    function sleep(ms) {
        return new Promise(resolve => setTimeout(resolve, ms));
    }
    function checkBounds(){
        if (i < 0){
            i = imgs.length - 1;
        } else if (i >= imgs.length){
            i = 0;
        }
    }
    function regress(){
        invisible(i);
        i--;
        checkBounds();
        visible(i);
    }
    function advance(){
        invisible(i);
        i++;
        checkBounds();
        visible(i);
    }
    async function play(){
        playing = true;
        playButton.className = playButton.className.replace("active", "hidden");
        pauseButton.className = pauseButton.className.replace("hidden", "active");
        while(playing){
            advance();
            await sleep(250);
        }
        playButton.className = playButton.className.replace("hidden", "active");
        pauseButton.className = pauseButton.className.replace("active", "hidden");
    }
    function pause(){
        playing = false;
    }
    function visible(index){
        imgs[index].className = imgs[index].className.replace("transparent", "visible");
    }
    function invisible(index){
        imgs[index].className = imgs[index].className.replace("visible", "transparent");
    }
</script>
{% endblock %}